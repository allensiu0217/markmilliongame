<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¦¬å¯ç¦éŸ³ç™¾è¬å¯Œç¿ - ç¶“æ–‡æŒ‘æˆ°ç‰ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap');
        
        :root {
            --gold: #d4af37;
            --safety: #10b981;
            --dark-bg: #0f172a;
        }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background: radial-gradient(circle at center, #1e1b4b 0%, #020617 100%);
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            margin: 0;
            overflow-x: hidden;
            user-select: none;
        }

        /* éŠæˆ²é‚Šæ¡†ç‰¹æ•ˆ */
        .gold-border {
            border: 2px solid var(--gold);
            box-shadow: 0 0 25px rgba(212, 175, 55, 0.15);
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(5px);
        }

        /* é¸é …æŒ‰éˆ•æ¨£å¼ */
        .option-btn {
            background: linear-gradient(145deg, #1e293b 0%, #0f172a 100%);
            border: 1px solid rgba(212, 175, 55, 0.3);
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .option-btn:hover:not(:disabled) {
            background: linear-gradient(145deg, #334155 0%, #1e293b 100%);
            border-color: var(--gold);
            transform: scale(1.02);
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.3);
            z-index: 10;
        }

        .option-btn.correct {
            background: linear-gradient(145deg, #059669 0%, #047857 100%) !important;
            border-color: #34d399 !important;
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.6);
            animation: pulse-green 1s infinite;
        }

        .option-btn.wrong {
            background: linear-gradient(145deg, #dc2626 0%, #991b1b 100%) !important;
            border-color: #f87171 !important;
        }

        @keyframes pulse-green {
            0% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(16, 185, 129, 0); }
            100% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0); }
        }

        /* æ±‚åŠ©æŒ‰éˆ• */
        .lifeline-btn {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            border: 2px solid var(--gold);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            font-weight: bold;
            background: rgba(0,0,0,0.4);
            font-size: 1.2rem;
        }

        .lifeline-btn:hover:not(.used) {
            background: var(--gold);
            color: black;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(212, 175, 55, 0.4);
        }

        .lifeline-btn.used {
            opacity: 0.4;
            border-color: #4b5563;
            color: #6b7280;
            cursor: not-allowed;
            position: relative;
        }
        
        .lifeline-btn.used::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 2px;
            background: #ef4444;
            transform: rotate(45deg);
        }

        /* çé‡‘éšæ¢¯æ¨£å¼ */
        .ladder-item {
            transition: all 0.3s;
            padding: 4px 12px;
            border-radius: 4px;
            margin-bottom: 2px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
            color: #94a3b8;
        }

        .ladder-item.active {
            background: linear-gradient(90deg, var(--gold), #b45309);
            color: white;
            font-weight: bold;
            transform: scale(1.05);
            box-shadow: 0 2px 10px rgba(0,0,0,0.5);
            border: 1px solid #fcd34d;
        }

        /* ä¿éšªç·šé¡¯çœ¼æ¨£å¼ */
        .milestone-bar {
            color: white !important;
            border: 1px solid var(--safety);
            background: rgba(16, 185, 129, 0.15);
            position: relative;
        }

        .milestone-bar span:last-child {
            color: var(--safety);
            font-weight: bold;
            text-shadow: 0 0 5px rgba(16, 185, 129, 0.5);
        }

        .milestone-bar::before {
            content: "ğŸ›¡ï¸";
            margin-right: 6px;
            font-size: 0.8rem;
        }

        /* Modal å‹•ç•« */
        .modal-enter {
            animation: modalPop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes modalPop {
            0% { opacity: 0; transform: scale(0.8); }
            100% { opacity: 1; transform: scale(1); }
        }
    </style>
</head>
<body>

    <!-- é ‚éƒ¨å°èˆª -->
    <header class="p-4 flex justify-between items-center bg-black/40 backdrop-blur-md border-b border-white/10 sticky top-0 z-50">
        <div class="flex items-center gap-2">
            <span class="text-2xl">ğŸ“–</span>
            <h1 class="text-xl font-bold tracking-widest text-gold italic hidden md:block">é¦¬å¯ç¦éŸ³ç™¾è¬å¯Œç¿</h1>
        </div>
        <div class="flex gap-4" id="lifelines">
            <button onclick="useLifeline('5050')" id="life-5050" class="lifeline-btn" title="50:50">50</button>
            <button onclick="useLifeline('phone')" id="life-phone" class="lifeline-btn" title="æ‰“é›»è©±">ğŸ“</button>
            <button onclick="useLifeline('audience')" id="life-audience" class="lifeline-btn" title="å•è§€çœ¾">ğŸ‘¥</button>
        </div>
    </header>

    <main class="flex-grow flex flex-col lg:flex-row p-4 gap-6 max-w-7xl mx-auto w-full">
        <!-- å·¦å´ï¼šéŠæˆ²ä¸»å€ -->
        <div class="flex-grow flex flex-col justify-center relative">
            
            <!-- é–‹å§‹ç•«é¢ -->
            <div id="start-screen" class="text-center py-10 lg:py-20 flex flex-col items-center">
                <div class="mb-8 relative inline-block">
                    <h2 class="text-6xl md:text-7xl font-black text-transparent bg-clip-text bg-gradient-to-b from-yellow-300 to-yellow-600 drop-shadow-sm mb-2">MARK</h2>
                    <h3 class="text-3xl md:text-4xl font-bold text-white tracking-[0.2em]">MILLIONAIRE</h3>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12 w-full max-w-3xl">
                    <div class="bg-slate-800/60 p-6 rounded-xl border border-white/10 hover:border-gold/50 transition-colors">
                        <p class="text-gold font-bold text-lg mb-2">ç†±èº«éšæ®µ</p>
                        <p class="text-slate-300 text-sm">ç¬¬ 1-5 é¡Œ</p>
                        <p class="text-safety font-bold mt-2 text-sm">ğŸ›¡ï¸ ä¿éšªç·š: $8,000</p>
                    </div>
                    <div class="bg-slate-800/60 p-6 rounded-xl border border-white/10 hover:border-gold/50 transition-colors">
                        <p class="text-gold font-bold text-lg mb-2">æŒ‘æˆ°éšæ®µ</p>
                        <p class="text-slate-300 text-sm">ç¬¬ 6-10 é¡Œ</p>
                        <p class="text-safety font-bold mt-2 text-sm">ğŸ›¡ï¸ ä¿éšªç·š: $200,000</p>
                    </div>
                    <div class="bg-slate-800/60 p-6 rounded-xl border border-white/10 hover:border-gold/50 transition-colors">
                        <p class="text-gold font-bold text-lg mb-2">å·”å³°éšæ®µ</p>
                        <p class="text-slate-300 text-sm">ç¬¬ 11-15 é¡Œ</p>
                        <p class="text-yellow-400 font-bold mt-2 text-sm">ğŸ† çµ‚é»: $1,000,000</p>
                    </div>
                </div>

                <button onclick="startGame()" class="group relative px-16 py-5 bg-gradient-to-r from-yellow-500 to-yellow-600 text-black font-bold text-2xl rounded-full shadow-[0_0_20px_rgba(234,179,8,0.5)] hover:shadow-[0_0_40px_rgba(234,179,8,0.7)] transition-all hover:-translate-y-1">
                    <span class="relative z-10">é–‹å§‹æŒ‘æˆ°</span>
                    <div class="absolute inset-0 rounded-full bg-white/20 blur-md opacity-0 group-hover:opacity-100 transition-opacity"></div>
                </button>
            </div>

            <!-- ç­”é¡Œç•«é¢ -->
            <div id="game-container" class="hidden w-full max-w-4xl mx-auto">
                <!-- é¡Œç›®æ¡† -->
                <div class="gold-border p-8 md:p-10 rounded-2xl text-center mb-8 relative bg-gradient-to-b from-slate-900 to-slate-950">
                    <div class="absolute -top-5 left-1/2 -translate-x-1/2">
                        <span id="level-badge" class="bg-gold text-black px-6 py-2 rounded-full font-bold shadow-lg text-sm tracking-wider">ç¬¬ 1 é¡Œ</span>
                    </div>
                    
                    <h2 id="question-text" class="text-2xl md:text-3xl font-bold leading-relaxed mt-4 mb-2 text-white">é¡Œç›®è¼‰å…¥ä¸­...</h2>
                    
                    <!-- ç¶“æ–‡å‡ºè™•é¡¯ç¤ºå€ -->
                    <div id="reference-container" class="h-8 mt-4 flex items-center justify-center">
                        <p id="reference-text" class="text-safety font-bold italic text-lg opacity-0 transition-opacity duration-500"></p>
                    </div>
                </div>

                <!-- é¸é …å€ -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6" id="options-grid">
                    <button onclick="selectOption(0)" class="option-btn p-5 rounded-xl text-left flex items-center group" id="opt-0">
                        <span class="text-gold font-black mr-4 text-2xl w-8">A</span> 
                        <span class="opt-text text-lg group-hover:text-white transition-colors text-slate-200"></span>
                    </button>
                    <button onclick="selectOption(1)" class="option-btn p-5 rounded-xl text-left flex items-center group" id="opt-1">
                        <span class="text-gold font-black mr-4 text-2xl w-8">B</span> 
                        <span class="opt-text text-lg group-hover:text-white transition-colors text-slate-200"></span>
                    </button>
                    <button onclick="selectOption(2)" class="option-btn p-5 rounded-xl text-left flex items-center group" id="opt-2">
                        <span class="text-gold font-black mr-4 text-2xl w-8">C</span> 
                        <span class="opt-text text-lg group-hover:text-white transition-colors text-slate-200"></span>
                    </button>
                    <button onclick="selectOption(3)" class="option-btn p-5 rounded-xl text-left flex items-center group" id="opt-3">
                        <span class="text-gold font-black mr-4 text-2xl w-8">D</span> 
                        <span class="opt-text text-lg group-hover:text-white transition-colors text-slate-200"></span>
                    </button>
                </div>

                <!-- åº•éƒ¨è³‡è¨Š -->
                <div class="mt-8 flex justify-between items-end border-t border-white/5 pt-4">
                    <button onclick="quitGame()" class="text-slate-400 hover:text-red-400 text-sm font-bold flex items-center gap-2 transition-colors px-3 py-2 rounded hover:bg-white/5">
                        <span>ğŸšª</span> æ”¾æ£„æŒ‘æˆ° (å¸¶èµ°çé‡‘)
                    </button>
                    <div class="text-right">
                        <p class="text-xs text-gold uppercase tracking-widest mb-1">ç•¶å‰çé‡‘</p>
                        <p id="current-prize-display" class="text-4xl font-black text-white tracking-tight text-shadow-gold">$0</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- å³å´ï¼šçé‡‘éšæ¢¯ -->
        <div class="w-full lg:w-80 bg-slate-900/80 backdrop-blur-sm p-5 rounded-2xl border border-white/10 shadow-2xl h-fit">
            <h3 class="text-center text-slate-400 mb-4 font-bold tracking-[0.2em] text-xs uppercase border-b border-white/5 pb-2">çé‡‘éšæ¢¯</h3>
            <div id="prize-ladder" class="flex flex-col-reverse gap-1">
                <!-- JS è‡ªå‹•å¡«å…… -->
            </div>
        </div>
    </main>

    <!-- å½ˆçª— (æ±‚åŠ©/çµæŸ) -->
    <div id="modal-overlay" class="fixed inset-0 bg-black/90 items-center justify-center p-4 z-[100] hidden backdrop-blur-sm">
        <div id="modal-box" class="bg-slate-900 border border-gold p-8 rounded-2xl max-w-md w-full text-center shadow-[0_0_50px_rgba(0,0,0,0.8)] modal-enter relative overflow-hidden">
            <!-- è£é£¾èƒŒæ™¯ -->
            <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-gold to-transparent"></div>
            
            <h2 id="modal-title" class="text-3xl font-black text-gold mb-4"></h2>
            <div id="modal-content" class="text-lg text-slate-200 mb-8 leading-relaxed"></div>
            
            <div id="game-over-stats" class="hidden bg-white/5 p-4 rounded-lg mb-6 border border-white/10">
                <p class="text-sm text-slate-400 uppercase mb-1">æœ€çµ‚ç²å¾—</p>
                <p id="modal-prize" class="text-4xl font-black text-white tracking-wide">$0</p>
            </div>

            <button onclick="closeModal()" id="modal-btn" class="w-full py-3 bg-gold text-black font-bold text-lg rounded-lg hover:bg-yellow-400 transition-colors">
                ç¢ºèª
            </button>
        </div>
    </div>

    <script>
        // çé‡‘çµæ§‹è¨­å®š (15éš)
        const prizes = [
            1000, 2000, 4000, 6000, 8000,          // Q1-5 (ä¿éšªç·š: 8000)
            10000, 20000, 50000, 100000, 200000,   // Q6-10 (ä¿éšªç·š: 200000)
            250000, 400000, 600000, 800000, 1000000 // Q11-15
        ];
        
        // é¡Œåº« (ç°¡å–® / ä¸­ç­‰ / å›°é›£)
        const masterQuestions = {
            easy: [
                { q: "è€¶ç©Œå—æ´—å¾Œï¼Œè–éˆé™åœ¨ä»–èº«ä¸Šå½¢ç‹€å½·å½¿ä»€éº¼ï¼Ÿ", r: "é¦¬å¯ç¦éŸ³ 1:10", a: ["ç«ç„°", "é´¿å­", "é›²å½©", "é¢¨"], c: 1 },
                { q: "è€¶ç©Œå‘¼å¬è¥¿é–€å’Œå®‰å¾—çƒˆæ™‚èªªï¼šæˆ‘è¦å«ä½ å€‘ç‚ºäººæˆä»€éº¼ï¼Ÿ", r: "é¦¬å¯ç¦éŸ³ 1:17", a: ["æ¼å¤«", "æœ¨åŒ ", "å¾—äººçš„æ¼å¤«", "ä½¿å¾’"], c: 2 },
                { q: "æ–½æ´—ç´„ç¿°åœ¨æ› é‡ç©¿çš„æ˜¯ä»€éº¼è¡£æœï¼Ÿ", r: "é¦¬å¯ç¦éŸ³ 1:6", a: ["ç´°éº»å¸ƒ", "é§±é§æ¯›", "ç¾Šçš®", "çµ²ç¶¢"], c: 1 },
                { q: "åœ¨è¿¦ç™¾è¾²ï¼Œå¹¾å€‹äººæŠ¬è‘—ç™±å­å»è¦‹è€¶ç©Œï¼Ÿ", r: "é¦¬å¯ç¦éŸ³ 2:3", a: ["2äºº", "4äºº", "6äºº", "8äºº"], c: 1 },
                { q: "è€¶ç©Œå¹³éœé¢¨æµªå¾Œï¼Œé–€å¾’å½¼æ­¤èªªï¼šé€™åˆ°åº•æ˜¯èª°ï¼Œé€£é¢¨å’Œä»€éº¼ä¹Ÿè½å¾ä»–äº†ï¼Ÿ", r: "é¦¬å¯ç¦éŸ³ 4:41", a: ["æµ·", "å±±", "é›¨", "é›·"], c: 0 },
                { q: "æ’’ç¨®çš„æ¯”å–»ä¸­ï¼Œæ’’åœ¨è·¯æ—çš„ä»£è¡¨ä»€éº¼è¢«å¥ªå»ï¼Ÿ", r: "é¦¬å¯ç¦éŸ³ 4:15", a: ["éŒ¢è²¡", "é“", "ç¨®å­", "ä¿¡å¿ƒ"], c: 1 },
                { q: "æœ‰ä¸€å€‹æ‚£è¡€æ¼çš„å©¦äººï¼Œç—…äº†å¤šå°‘å¹´ï¼Ÿ", r: "é¦¬å¯ç¦éŸ³ 5:25", a: ["10å¹´", "12å¹´", "18å¹´", "38å¹´"], c: 1 }
            ],
            medium: [
                { q: "è€¶ç©Œå°ç®¡æœƒå ‚çš„èªªï¼šã€Œä¸è¦æ€•ï¼Œåªè¦...ã€ï¼Ÿ", r: "é¦¬å¯ç¦éŸ³ 5:36", a: ["ä¿¡", "ç¦±å‘Š", "çœ‹", "æ‚”æ”¹"], c: 0 },
                { q: "ã€Œå¤§åˆ©å¤§å¤ç±³ã€ç¿»å‡ºä¾†çš„æ„æ€æ˜¯ä»€éº¼ï¼Ÿ", r: "é¦¬å¯ç¦éŸ³ 5:41", a: ["é–¨å¥³ï¼Œæˆ‘å©å’å¦³èµ·ä¾†", "ç¥èˆ‡å¦³åŒåœ¨", "å¹³å®‰äº†", "é–‹äº†å§"], c: 0 },
                { q: "è€¶ç©Œå•é–€å¾’ï¼šæˆ‘æ˜¯èª°ï¼Ÿå½¼å¾—å›ç­”èªªï¼šä½ æ˜¯...ï¼Ÿ", r: "é¦¬å¯ç¦éŸ³ 8:29", a: ["å…ˆçŸ¥", "åŸºç£", "ä»¥åˆ©äº", "äººå­"], c: 1 },
                { q: "è€¶ç©Œç™»å±±è®Šåƒæ™‚ï¼Œå“ªå…©ä½é¡¯ç¾èˆ‡è€¶ç©Œèªªè©±ï¼Ÿ", r: "é¦¬å¯ç¦éŸ³ 9:4", a: ["æ‘©è¥¿ã€äºä¼¯æ‹‰ç½•", "ä»¥åˆ©äºã€æ‘©è¥¿", "å¤§è¡›ã€ä»¥è³½äº", "ä»¥è«¾ã€ä»¥åˆ©äº"], c: 1 },
                { q: "è€¶ç©Œèªªï¼šè®“å°å­©å­åˆ°æˆ‘é€™è£¡ä¾†ï¼Œå› ç‚ºåœ¨ç¥åœ‹çš„ï¼Œæ­£æ˜¯...ï¼Ÿ", r: "é¦¬å¯ç¦éŸ³ 10:14", a: ["é€™æ¨£çš„äºº", "èª å¯¦çš„äºº", "è¬™å‘çš„äºº", "å—è‹¦çš„äºº"], c: 0 },
                { q: "è€¶ç©Œé¨é©¢é€²è€¶è·¯æ’’å†·æ™‚ï¼Œçœ¾äººå–Šè‘—èªªä»€éº¼ï¼Ÿ", r: "é¦¬å¯ç¦éŸ³ 11:9", a: ["é˜¿å€‘", "å’Œæ•£é‚£", "å“ˆåˆ©è·¯äº", "ä»¥é¦¬å…§åˆ©"], c: 1 },
                { q: "æœ€å¤§çš„èª¡å‘½æ„›ç¥ï¼Œå’Œä»€éº¼ï¼Ÿ", r: "é¦¬å¯ç¦éŸ³ 12:31", a: ["æ„›äººå¦‚å·±", "å­æ•¬çˆ¶æ¯", "ä¸å¯æ®ºäºº", "éµå®ˆå®‰æ¯æ—¥"], c: 0 }
            ],
            hard: [
                { q: "è€¶ç©Œåœ¨å®¢è¥¿é¦¬å°¼ç¦±å‘Šèªªï¼šã€Œé˜¿çˆ¸ï¼çˆ¶å•Šï¼åœ¨ä½ å‡¡äº‹éƒ½èƒ½ï¼Œæ±‚ä½ å°‡é€™...æ’¤å»ã€ï¼Ÿ", r: "é¦¬å¯ç¦éŸ³ 14:36", a: ["è‹¦é›£", "æ¯", "é‡æ“”", "æ™‚åˆ»"], c: 1 },
                { q: "è€¶ç©Œå—é›£æ™‚ï¼Œå¾ä»€éº¼æ™‚å€™åˆ°ç”³åˆéåœ°éƒ½é»‘æš—äº†ï¼Ÿ", r: "é¦¬å¯ç¦éŸ³ 15:33", a: ["å·³åˆ", "åˆæ­£", "æœªæ™‚", "å¯æ™‚"], c: 1 },
                { q: "ã€Œä»¥åˆ©ï¼ä»¥åˆ©ï¼æ‹‰é¦¬æ’’å·´å„å¤§å°¼ã€æ˜¯ä»€éº¼æ„æ€ï¼Ÿ", r: "é¦¬å¯ç¦éŸ³ 15:34", a: ["æˆäº†", "çˆ¶å•Šèµ¦å…ä»–å€‘", "æˆ‘çš„ç¥ç‚ºä»€éº¼é›¢æ£„æˆ‘", "æˆ‘å°‡éˆé­‚äº¤åœ¨ä½ æ‰‹è£¡"], c: 2 },
                { q: "æ˜¯èª°å»å‘å½¼æ‹‰å¤šæ±‚è€¶ç©Œçš„èº«é«”å®‰è‘¬ï¼Ÿ", r: "é¦¬å¯ç¦éŸ³ 15:43", a: ["å°¼å“¥åº•æ¯", "äºåˆ©é¦¬å¤ªçš„ç´„ç‘Ÿ", "å¤åˆ©å¥ˆäººè¥¿é–€", "æŠ¹å¤§æ‹‰çš„é¦¬åˆ©äº"], c: 1 },
                { q: "è€¶ç©Œå¾©æ´»å¾Œï¼Œé¦–å…ˆå‘èª°é¡¯ç¾ï¼Ÿ", r: "é¦¬å¯ç¦éŸ³ 16:9", a: ["å½¼å¾—", "æŠ¹å¤§æ‹‰çš„é¦¬åˆ©äº", "é›…å„", "ä»¥é¦¬å¿¤æ–¯çš„é–€å¾’"], c: 1 },
                { q: "è€¶ç©Œå—è©¦æ¢æ™‚ï¼Œèˆ‡ä»€éº¼åŒåœ¨ä¸€è™•ï¼Ÿ", r: "é¦¬å¯ç¦éŸ³ 1:13", a: ["é‡ç¸", "é­”é¬¼", "å¼·ç›œ", "ç—²ç˜‹ç—…äºº"], c: 0 },
                { q: "æœ‰ä¸€å€‹å°‘å¹´äººèµ¤èº«é€ƒèµ°ï¼Œé€™è¨˜è¼‰åœ¨å“ªä¸€ç« ï¼Ÿ", r: "é¦¬å¯ç¦éŸ³ 14:51", a: ["ç¬¬13ç« ", "ç¬¬14ç« ", "ç¬¬15ç« ", "ç¬¬16ç« "], c: 1 }
            ]
        };

        let currentLevel = 0;
        let questionsPool = [];
        let lifelines = { '5050': true, 'phone': true, 'audience': true };
        let isLocked = false;
        let isGameOver = false;

        // åˆå§‹åŒ–éšæ¢¯
        function initPrizeLadder() {
            const ladder = document.getElementById('prize-ladder');
            ladder.innerHTML = '';
            
            prizes.forEach((p, i) => {
                const div = document.createElement('div');
                div.id = `ladder-${i}`;
                div.className = "ladder-item";
                
                // è¨­å®šä¿éšªç·šæ¨£å¼
                let safetyBadge = "";
                let isMilestone = false;
                
                if (i === 4 || i === 9) {
                    div.classList.add('milestone-bar');
                    isMilestone = true;
                }
                
                // æ ¼å¼åŒ–æ•¸å­—
                const prizeText = p.toLocaleString();
                
                div.innerHTML = `
                    <span class="font-mono ${isMilestone ? 'text-white' : 'text-slate-500'} w-6">${i + 1}</span>
                    <span class="font-bold flex-grow text-right tracking-wide">$${prizeText}</span>
                `;
                ladder.appendChild(div);
            });
        }

        // é–‹å§‹éŠæˆ²
        function startGame() {
            // æ´—ç‰Œä¸¦é¸é¡Œ (æ¯éšæ®µ5é¡Œ)
            const shuffle = (arr) => [...arr].sort(() => Math.random() - 0.5).slice(0, 5);
            questionsPool = [
                ...shuffle(masterQuestions.easy),
                ...shuffle(masterQuestions.medium),
                ...shuffle(masterQuestions.hard)
            ];
            
            currentLevel = 0;
            isLocked = false;
            isGameOver = false;
            
            // é‡ç½® UI
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('game-container').classList.remove('hidden');
            document.querySelectorAll('.lifeline-btn').forEach(btn => btn.classList.remove('used'));
            lifelines = { '5050': true, 'phone': true, 'audience': true };
            
            loadQuestion();
        }

        // è¼‰å…¥é¡Œç›®
        function loadQuestion() {
            const q = questionsPool[currentLevel];
            
            // æ›´æ–°é¡Œç›®æ–‡å­—
            document.getElementById('level-badge').innerText = `ç¬¬ ${currentLevel + 1} / 15 é¡Œ`;
            document.getElementById('question-text').innerText = q.q;
            
            // éš±è—ä¸¦é‡ç½®ç¶“æ–‡å‡ºè™•
            const refText = document.getElementById('reference-text');
            refText.style.opacity = '0';
            refText.innerText = "";
            
            // æ›´æ–°é¸é …
            const btns = document.querySelectorAll('.option-btn');
            btns.forEach((btn, i) => {
                btn.className = "option-btn p-5 rounded-xl text-left flex items-center group"; // é‡ç½® class
                btn.style.opacity = "1";
                btn.disabled = false;
                btn.querySelector('.opt-text').innerText = q.a[i];
            });

            // æ›´æ–°éšæ¢¯é«˜äº®
            document.querySelectorAll('.ladder-item').forEach(d => d.classList.remove('active'));
            const currentStep = document.getElementById(`ladder-${currentLevel}`);
            if(currentStep) {
                currentStep.classList.add('active');
                currentStep.scrollIntoView({behavior: "smooth", block: "center"});
            }
            
            // æ›´æ–°ç›®å‰çé‡‘ (é¡¯ç¤ºä¸Šä¸€é¡Œçš„çé‡‘ï¼Œå¦‚æœç¬¬ä¸€é¡Œå‰‡é¡¯ç¤º0)
            const currentPrize = currentLevel > 0 ? prizes[currentLevel-1] : 0;
            document.getElementById('current-prize-display').innerText = `$${currentPrize.toLocaleString()}`;
            
            isLocked = false;
        }

        // é¸æ“‡ç­”æ¡ˆ
        function selectOption(idx) {
            if (isLocked) return;
            isLocked = true;
            
            const q = questionsPool[currentLevel];
            const btn = document.getElementById(`opt-${idx}`);
            const correctBtn = document.getElementById(`opt-${q.c}`);
            
            // é¡¯ç¤ºç¶“æ–‡å‡ºè™•
            const refText = document.getElementById('reference-text');
            refText.innerText = `ğŸ“– ${q.r}`;
            refText.style.opacity = '1';

            if (idx === q.c) {
                // ç­”å°
                btn.classList.add('correct');
                playSound('correct');
                
                setTimeout(() => {
                    currentLevel++;
                    if (currentLevel >= 15) {
                        endGame(true);
                    } else {
                        loadQuestion();
                    }
                }, 2500); // å»¶é•·æ™‚é–“è®“ç©å®¶çœ‹ç¶“æ–‡
            } else {
                // ç­”éŒ¯
                btn.classList.add('wrong');
                correctBtn.classList.add('correct');
                playSound('wrong');
                setTimeout(() => endGame(false), 3000);
            }
        }

        // çµæŸéŠæˆ²
        function endGame(isWin) {
            isGameOver = true;
            let finalPrize = 0;
            let title = "";
            let msg = "";
            
            if (isWin) {
                finalPrize = 1000000;
                title = "ğŸ‰ æŒ‘æˆ°æˆåŠŸï¼";
                msg = "å“ˆåˆ©è·¯äºï¼ä½ å·²ç¶“ç²¾é€šé¦¬å¯ç¦éŸ³ï¼Œç²å¾—äº†æœ€é«˜æ¦®è­½ï¼";
            } else {
                // è¨ˆç®—ä¿éšªé‡‘
                if (currentLevel >= 10) finalPrize = 200000;
                else if (currentLevel >= 5) finalPrize = 8000;
                else finalPrize = 0;
                
                title = "æŒ‘æˆ°çµæŸ";
                msg = `å¾ˆå¯æƒœï¼Œä½†åœ¨ç¥çš„è©±èªä¸­æ²’æœ‰å¤±æ•—ã€‚`;
            }
            
            showModal(title, msg, finalPrize, true);
        }

        // æ”¾æ£„éŠæˆ²
        function quitGame() {
            if (isLocked) return;
            const finalPrize = currentLevel > 0 ? prizes[currentLevel-1] : 0;
            showModal("ğŸ’° å¸¶è‘—çé‡‘é›¢é–‹", "æ˜æ™ºçš„é¸æ“‡ï¼æœ‰äº›æ™‚å€™ï¼ŒçŸ¥è¶³ä¹Ÿæ˜¯ä¸€ç¨®æ™ºæ…§ã€‚", finalPrize, true);
        }

        // æ±‚åŠ©åŠŸèƒ½
        function useLifeline(type) {
            if (!lifelines[type] || isLocked) return;
            
            lifelines[type] = false;
            document.getElementById(`life-${type}`).classList.add('used');
            
            const q = questionsPool[currentLevel];
            const correctLetter = ["A", "B", "C", "D"][q.c];
            
            if (type === '5050') {
                // åˆªå»å…©å€‹éŒ¯èª¤ç­”æ¡ˆ
                let wrongIndices = [0,1,2,3].filter(i => i !== q.c);
                wrongIndices.sort(() => Math.random() - 0.5);
                wrongIndices.slice(0, 2).forEach(i => {
                    document.getElementById(`opt-${i}`).style.opacity = "0.2";
                    document.getElementById(`opt-${i}`).disabled = true;
                });
            } else if (type === 'phone') {
                showModal("ğŸ“ ç‰§å¸«é€£ç·šä¸­...", `ç‰§å¸«æ€è€ƒäº†ä¸€ä¸‹èªªï¼š<br>ã€Œé€™æ®µç¶“æ–‡æˆ‘è¬›é“æ™‚æéï¼Œåœ¨ <b>${q.r}</b>ã€‚<br>æˆ‘æœ‰ä¹æˆæŠŠæ¡ç­”æ¡ˆæ˜¯ <b>${correctLetter}</b>ã€‚ã€`);
            } else if (type === 'audience') {
                showModal("ğŸ‘¥ è§€çœ¾æŠ•ç¥¨çµæœ", `ç¾å ´è§€çœ¾ç¿»é–±è–ç¶“å¾Œçš„çµ±è¨ˆï¼š<br><br>A: ${q.c===0?75:10}%<br>B: ${q.c===1?75:10}%<br>C: ${q.c===2?75:10}%<br>D: ${q.c===3?75:10}%<br><br>å¤§éƒ¨ä»½äººèªç‚ºç­”æ¡ˆæ˜¯ <b>${correctLetter}</b>`);
            }
        }

        // é¡¯ç¤º Modal
        function showModal(title, content, prize = null, isEnd = false) {
            const modal = document.getElementById('modal-overlay');
            const stats = document.getElementById('game-over-stats');
            const btn = document.getElementById('modal-btn');
            
            document.getElementById('modal-title').innerHTML = title;
            document.getElementById('modal-content').innerHTML = content;
            
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            
            if (prize !== null) {
                stats.classList.remove('hidden');
                document.getElementById('modal-prize').innerText = `$${prize.toLocaleString()}`;
                btn.innerText = "é‡æ–°é–‹å§‹";
                btn.onclick = () => location.reload();
            } else {
                stats.classList.add('hidden');
                btn.innerText = "å›åˆ°éŠæˆ²";
                btn.onclick = closeModal;
            }
        }

        function closeModal() {
            document.getElementById('modal-overlay').classList.add('hidden');
            document.getElementById('modal-overlay').classList.remove('flex');
        }

        // ç°¡æ˜“éŸ³æ•ˆæ¨¡æ“¬ (ä¸ä½¿ç”¨å¤–éƒ¨æª”æ¡ˆ)
        function playSound(type) {
            // é€™è£¡å¯ä»¥åŠ å…¥ Audio APIï¼Œä½†åœ¨å–®ä¸€æ–‡ä»¶ä¸­ä¿æŒç°¡å–®
        }

        // å•Ÿå‹•åˆå§‹åŒ–
        initPrizeLadder();
    </script>
</body>
</html>
